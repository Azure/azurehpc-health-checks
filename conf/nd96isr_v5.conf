# NHC Configuration File
#
# Lines are in the form "<hostmask>||<check>"
# Hostmask is a glob, /regexp/, or {noderange}
# Comments begin with '#'
#
# This file was automatically generated by nhc-genconf
# Sat May 6 00:05:37 UTC 2023
#

#######################################################################
###
### Filesystem checks
###
 ndv5-vm-0 || check_fs_mount_rw -t "ext4" -s "/dev/root" -f "/"
 ndv5-vm-0 || check_fs_mount_rw -t "devtmpfs" -s "devtmpfs" -f "/dev"
 ndv5-vm-0 || check_fs_mount_rw -t "proc" -s "proc" -f "/proc"
 ndv5-vm-0 || check_fs_mount_rw -t "sysfs" -s "sysfs" -f "/sys"
 ndv5-vm-0 || check_fs_mount_rw -t "securityfs" -s "securityfs" -f "/sys/kernel/security"
 ndv5-vm-0 || check_fs_mount_rw -t "tmpfs" -s "tmpfs" -f "/dev/shm"
 ndv5-vm-0 || check_fs_mount_rw -t "devpts" -s "devpts" -f "/dev/pts"
 ndv5-vm-0 || check_fs_mount_rw -t "tmpfs" -s "tmpfs" -f "/run"
 ndv5-vm-0 || check_fs_mount_rw -t "tmpfs" -s "tmpfs" -f "/run/lock"
 ndv5-vm-0 || check_fs_mount_rw -t "pstore" -s "pstore" -f "/sys/fs/pstore"
 ndv5-vm-0 || check_fs_mount_rw -t "efivarfs" -s "efivarfs" -f "/sys/firmware/efi/efivars"
 ndv5-vm-0 || check_fs_mount_rw -t "bpf" -s "bpf" -f "/sys/fs/bpf"
 ndv5-vm-0 || check_fs_mount_rw -t "hugetlbfs" -s "hugetlbfs" -f "/dev/hugepages"
 ndv5-vm-0 || check_fs_mount_rw -t "mqueue" -s "mqueue" -f "/dev/mqueue"
 ndv5-vm-0 || check_fs_mount_rw -t "debugfs" -s "debugfs" -f "/sys/kernel/debug"
 ndv5-vm-0 || check_fs_mount_rw -t "tracefs" -s "tracefs" -f "/sys/kernel/tracing"
 ndv5-vm-0 || check_fs_mount_rw -t "fusectl" -s "fusectl" -f "/sys/fs/fuse/connections"
 ndv5-vm-0 || check_fs_mount_rw -t "configfs" -s "configfs" -f "/sys/kernel/config"
 ndv5-vm-0 || check_fs_mount_ro -t "ramfs" -s "none" -f "/run/credentials/systemd-sysusers.service"
 ndv5-vm-0 || check_fs_mount_ro -t "squashfs" -s "/dev/loop0" -f "/snap/core20/1852"
 ndv5-vm-0 || check_fs_mount_ro -t "squashfs" -s "/dev/loop1" -f "/snap/lxd/24322"
 ndv5-vm-0 || check_fs_mount_rw -t "vfat" -s "/dev/sda15" -f "/boot/efi"
 ndv5-vm-0 || check_fs_mount_rw -t "tracefs" -s "tracefs" -f "/sys/kernel/debug/tracing"
 ndv5-vm-0 || check_fs_mount_rw -t "tmpfs" -s "tmpfs" -f "/run/snapd/ns"
 ndv5-vm-0 || check_fs_mount_rw -t "nsfs" -s "nsfs" -f "/run/snapd/ns/lxd.mnt"
 ndv5-vm-0 || check_fs_mount_rw -t "tmpfs" -s "tmpfs" -f "/run/user/1000"
 ndv5-vm-0 || check_fs_mount_ro -t "squashfs" -s "/dev/loop3" -f "/snap/snapd/18933"
 ndv5-vm-0 || check_fs_mount_ro -t "squashfs" -s "/dev/loop4" -f "/snap/snapd/19122"
 ndv5-vm-0 || check_fs_mount_ro -t "squashfs" -s "/dev/loop5" -f "/snap/core20/1879"
 ndv5-vm-0 || check_fs_used / 90%
 ndv5-vm-0 || check_fs_used /dev 90%
 ndv5-vm-0 || check_fs_used /snap/core20/1852 100%
 ndv5-vm-0 || check_fs_used /snap/lxd/24322 100%
 ndv5-vm-0 || check_fs_used /boot/efi 90%
 ndv5-vm-0 || check_fs_used /snap/snapd/18933 100%
 ndv5-vm-0 || check_fs_used /snap/snapd/19122 100%
 ndv5-vm-0 || check_fs_used /snap/core20/1879 100%
 ndv5-vm-0 || check_fs_iused / 100%
 ndv5-vm-0 || check_fs_iused /dev 98%
 ndv5-vm-0 || check_fs_iused /snap/core20/1852 12k
 ndv5-vm-0 || check_fs_iused /snap/core20/1879 12k


#######################################################################
###
### Hardware checks
###
 ndv5-vm-0 || check_hw_cpuinfo 2 96 96
 ndv5-vm-0 || check_hw_physmem 1915071MB 1915071MB 5%
 ndv5-vm-0 || check_hw_swap 0kB 0kB 3%
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib0:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib1:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib2:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib3:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib4:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib5:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib6:1
 ndv5-vm-0 || check_hw_ib 400 mlx5_ib7:1
 ndv5-vm-0 || check_hw_eth lo
 ndv5-vm-0 || check_hw_eth eth0
 ndv5-vm-0 || check_hw_eth ib0
 ndv5-vm-0 || check_hw_eth ib1
 ndv5-vm-0 || check_hw_eth ib2
 ndv5-vm-0 || check_hw_eth ib3
 ndv5-vm-0 || check_hw_eth ib4
 ndv5-vm-0 || check_hw_eth ib5
 ndv5-vm-0 || check_hw_eth ib6
 ndv5-vm-0 || check_hw_eth ib7
 ndv5-vm-0 || check_hw_eth docker0


#######################################################################
###
### Process checks
###
 ndv5-vm-0 || check_ps_loadavg 192
 ndv5-vm-0 || check_ps_service -r rpcbind
 ndv5-vm-0 || check_ps_service -S -u root auditd
